<div id="channel">
  <div id="messages">
    <%= render partial: 'messages/message', collection: @channel.messages %>
  </div>
  <div id="last_message">&nbsp;</div>
  
  <%= render 'messages/form' %>
</div>

<div id="channel_info">
  <h1 id="channel_name"><%= @channel.name %></h1>
  <h2 id="channel_current_topic">
    <span id="topic"><%= messageize(@channel.current_topic).html_safe unless @channel.current_topic.nil? %></span>
    <span id="change_topic">
      <% if @channel.current_topic.present? %>
        <%= link_to_function t('views.channels.show.change_topic'), 'showChangeTopicForm()' %>
      <% else %>
        <%= link_to_function t('views.channels.show.add_a_topic'), 'showChangeTopicForm()', class: 'important' %>
      <% end %>
    </span>
  </h2>
  <div id="change_topic_form">
    <%= render 'change_topic_form' %>
  </div>
  
  <div id="online_users">
    <h2><%=t 'views.channels.show.online_users' %></h2>
    <ul>
      <%= render partial: 'users/user_li', collection: @channel.online_users, as: 'user' %>
    </ul>
  </div>
  
  <div id="allowed_users">
    <h2><%=t 'simple_form.labels.channel.users' %></h2>
    <ul>
      <%= render partial: 'users/user_li', collection: @channel.users, as: 'user' %>
    </ul>
  </div>
</div>

<%= subscribe_to @channel.pub_sub_name %>
<%= subscribe_to @channel.im_online_name %>
<script>
  $('#header').addClass('fixed_header');
  imOnline(<%= @channel.id %>);
</script>
